<!DOCTYPE html>
<html lang="pt-BR">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reuni√µes & Eventos</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

    <style>
        /* Vari√°veis de Cores (Design Renovado) */
        :root {
            --cor-fundo: #f0f4f9;
            /* Fundo suave e levemente azulado */
            --cor-card: #ffffff;
            /* Branco Puro */
            --cor-texto-principal: #1e3a5f;
            /* Azul escuro profissional */
            --cor-texto-secundario: #6b7a8f;
            /* Cinza suave */

            /* Cores de Se√ß√£o Aprimoradas e Ligeiramente Suavizadas */
            --cor-reuniao: #3b82f6;
            /* Azul Claro/Brilhante */
            --cor-evento: #f97316;
            /* Laranja Vibrante */
            --cor-reuniao-dark: #2563eb;
            --cor-evento-dark: #ea580c;

            --cor-sucesso: #10b981;
            /* Verde Profissional */
            --cor-alerta: #f59e0b;
            /* Amarelo Ouro */
            --cor-erro: #ef4444;
            /* Vermelho Forte */
            --cor-divisoria: #e2e8f0;
            /* Cinza Gelo para divis√µes */

            /* üí° Sombra Renovada: Mais camadas e mais suave */
            --sombra-suave: 0 4px 15px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.08);

            /* Cores da Tabela */
            --cor-header-reuniao: var(--cor-reuniao-dark);
            --cor-header-evento: var(--cor-evento-dark);
            --cor-header-texto: #ffffff;
            --cor-linha-impar: #ffffff;
            --cor-linha-par: #f9fafb;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--cor-fundo);
            margin: 0;
            padding: 0;
            color: var(--cor-texto-principal);
            line-height: 1.6;
            min-height: 100vh;
            box-sizing: border-box;
            font-size: 16px;
        }

        .main-container {
            width: 100%;
            max-width: none;
            margin: 0 auto;
            box-sizing: border-box;
            padding: 30px;
        }

        .main-header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--cor-divisoria);
        }

        .main-title {
            font-size: 3.2em;
            font-weight: 800;
            color: var(--cor-texto-principal);
            margin: 0;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.3em;
            color: var(--cor-texto-secundario);
            margin-top: 8px;
            font-weight: 400;
        }

        /* --- GRID PRINCIPAL COMPARATIVO (2 Colunas) --- */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .dashboard-section {
            padding: 0;
        }

        .dashboard-section.reunioes {
            border-right: 1px solid var(--cor-divisoria);
            padding-right: 15px;
        }

        .dashboard-section.eventos {
            padding-left: 15px;
        }

        /* --- Headers de Se√ß√£o (Estilo aprimorado com underline simples) --- */

        .section-header {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 30px;
            padding-bottom: 10px;
            letter-spacing: -0.5px;
            position: relative;
        }

        /* Linha decorativa abaixo do t√≠tulo da se√ß√£o */
        .section-header::after {
            content: '';
            display: block;
            width: 60px;
            /* Linha curta */
            height: 4px;
            position: absolute;
            bottom: -2px;
            left: 0;
            background-color: currentColor;
            /* Usa a cor do texto do header */
            border-radius: 2px;
        }

        .reunioes .section-header {
            color: var(--cor-reuniao-dark);
        }

        .eventos .section-header {
            color: var(--cor-evento-dark);
        }

        /* --- Grids Internos (KPIs e Gr√°fico/Tabela) --- */

        .kpi-grid,
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .content-grid {
            grid-template-columns: 1fr;
        }

        .kpi-grid .status-box {
            grid-column: 1 / -1;
        }

        /* --- Cards de Estat√≠sticas (KPIs) - ESTILO RENOVADO --- */
        .kpi-card {
            background-color: var(--cor-card);
            padding: 20px;
            /* üí° Raio de Borda aumentado para suavidade */
            border-radius: 16px;
            box-shadow: var(--sombra-suave);
            display: flex;
            align-items: center;
            justify-content: space-between;
            /* üí° Transi√ß√£o mais suave */
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            /* üí° Novo destaque: Borda esquerda grossa */
            border-left: 5px solid;
            border-bottom: none !important;
        }

        /* Efeito de eleva√ß√£o mais forte no hover */
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Cores da borda esquerda */
        .reunioes .kpi-card {
            border-left-color: var(--cor-reuniao);
        }

        .eventos .kpi-card {
            border-left-color: var(--cor-evento);
        }

        .kpi-card.kpi-success {
            border-left-color: var(--cor-sucesso) !important;
        }

        .kpi-card.kpi-alert {
            border-left-color: var(--cor-alerta) !important;
        }


        .kpi-info h4 {
            margin: 0 0 8px 0;
            font-size: 0.9em;
            color: var(--cor-texto-secundario);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-info p {
            margin: 0;
            font-size: 2.2em;
            font-weight: 800;
            line-height: 1;
        }

        .kpi-icon i {
            font-size: 2.5em;
            opacity: 0.2;
        }

        .reunioes .kpi-icon i {
            color: var(--cor-reuniao-dark);
        }

        .eventos .kpi-icon i {
            color: var(--cor-evento-dark);
        }

        /* Status Box - ESTILO RENOVADO */
        .status-box {
            padding: 25px;
            /* üí° Raio de Borda aumentado para suavidade */
            border-radius: 16px;
            font-weight: 600;
            box-shadow: var(--sombra-suave);
            text-align: left;
            transition: all 0.3s ease;
        }

        .status-box h3 {
            margin-top: 0;
            font-size: 1.6em;
            margin-bottom: 8px;
            font-weight: 700;
            line-height: 1.2;
        }

        .status-box p {
            margin-bottom: 0;
            font-size: 1.1em;
            font-weight: 400;
            opacity: 0.9;
        }

        /* Cores do Status Box de Hoje - Limpo e com "Glow" */
        .status-hoje {
            background-color: var(--cor-sucesso);
            color: #ffffff;
            border-left: 10px solid #047857;
            /* Borda mais escura para contraste */
            /* üí° Efeito "Glow" */
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .reunioes .status-proxima {
            background-color: var(--cor-card);
            border: 1px solid var(--cor-reuniao);
            color: var(--cor-texto-principal);
            border-left: 5px solid var(--cor-reuniao);
        }

        .eventos .status-proxima {
            background-color: var(--cor-card);
            border: 1px solid var(--cor-evento);
            color: var(--cor-texto-principal);
            border-left: 5px solid var(--cor-evento);
        }

        .status-sem-dados {
            background-color: #fef2f2;
            border: 1px solid var(--cor-erro);
            color: var(--cor-erro);
            border-left: 5px solid var(--cor-erro);
        }

        .status-sem-dados h3,
        .status-sem-dados p {
            color: var(--cor-erro);
        }

        .status-proxima h3 {
            color: var(--cor-texto-principal);
        }


        /* --- Se√ß√£o de Dados (Gr√°fico e Tabela) --- */
        .data-section-card {
            background-color: var(--cor-card);
            padding: 25px;
            /* üí° Raio de Borda aumentado para suavidade */
            border-radius: 16px;
            box-shadow: var(--sombra-suave);
            min-height: 120px;
            margin-bottom: 0;
            box-sizing: border-box;
        }

        .section-sub-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 5px;
            color: var(--cor-texto-principal);
            border-bottom: 1px solid var(--cor-divisoria);
        }

        /* Tabela */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.9em;
            text-align: left;
            /* Aplicando overflow: hidden e border-radius diretamente para as tabelas que n√£o rolam */
            /* Isso garante que o header arredonde no topo */
            overflow: hidden;
            border-radius: 10px;
            border: 1px solid var(--cor-divisoria);
            /* Borda sutil para indicar o limite da tabela */
        }

        /* Ajustando as tabelas que est√£o diretamente no data-section-card e n√£o no scroll container */
        .data-section-card>.data-table {
            margin-top: 15px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--cor-divisoria);
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        /* Garantir que a √∫ltima linha da tabela n√£o tenha borda inferior */
        .data-table tbody tr:last-child td {
            border-bottom: none;
        }


        .data-table thead th {
            font-weight: 700;
            text-transform: uppercase;
            color: var(--cor-header-texto);
            letter-spacing: 0.5px;
            font-size: 0.95em;
        }

        .reunioes .data-table thead th {
            background-color: var(--cor-header-reuniao);
        }

        .eventos .data-table thead th {
            background-color: var(--cor-header-evento);
        }

        .data-table tbody tr:nth-child(odd) {
            background-color: var(--cor-linha-impar);
        }

        .data-table tbody tr:nth-child(even) {
            background-color: var(--cor-linha-par);
        }


        .empty-cell {
            color: var(--cor-texto-secundario);
            font-style: italic;
            opacity: 0.7;
            padding: 15px 0;
            display: block;
            text-align: center !important;
        }

        /* --- Estilos do Filtro de Ano --- */
        .chart-filter-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            gap: 10px;
            font-size: 1em;
            font-weight: 500;
            color: var(--cor-texto-secundario);
        }

        .year-filter {
            padding: 8px 12px;
            border: 1px solid var(--cor-divisoria);
            border-radius: 8px;
            background-color: #f7f7f7;
            color: var(--cor-texto-principal);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .year-filter:focus {
            border-color: var(--cor-reuniao-dark);
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        /* --- Gr√°fico Mensal (Ajustado com espa√ßamento para evitar corte) --- */

        .bar-chart-container {
            display: flex;
            width: 100%;
            height: 250px;
            align-items: flex-end;
            border-left: 1px solid var(--cor-divisoria);
            border-bottom: none;
            /* ‚ùå Eixo X removido */
            /* üí° CORRE√á√ÉO: Aumentado para evitar corte do valor no topo */
            padding: 35px 0 0 5px;
            gap: 10px;
            overflow-x: auto;
            margin-top: 10px;
            padding-bottom: 25px;
            justify-content: space-between;
        }

        .monthly-bar-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            height: 100%;
            flex: 1 1 0;
            min-width: 50px;
            transition: transform 0.2s ease-in-out;
            cursor: default;
        }

        .monthly-bar-wrapper:hover {
            transform: scale(1.03);
        }

        .monthly-bar {
            width: 85%;
            transition: height 0.3s ease;
            border-radius: 6px 6px 0 0;
            position: relative;
            /* Sombra sutil para profundidade */
            box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.1);
        }

        /* R√≥tulo de valor no topo da barra */
        .monthly-bar-value {
            font-size: 0.9em;
            font-weight: 800;
            position: absolute;
            top: -18px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
        }

        /* R√≥tulo do m√™s */
        .monthly-bar-label {
            font-size: 0.8em;
            color: var(--cor-texto-secundario);
            margin-top: 4px;
            font-weight: 600;
        }


        /* Cores espec√≠ficas das se√ß√µes */
        .reunioes .monthly-bar-value {
            color: var(--cor-reuniao-dark);
        }

        .eventos .monthly-bar-value {
            color: var(--cor-evento-dark);
        }

        .chart-info-box {
            background-color: var(--cor-divisoria);
            padding: 12px;
            /* üí° Raio de Borda aumentado */
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid;
            font-size: 0.9em;
        }

        .reunioes .chart-info-box {
            border-left-color: var(--cor-reuniao);
        }

        .eventos .chart-info-box {
            border-left-color: var(--cor-evento);
        }

        .chart-info-box p {
            margin: 0;
            color: var(--cor-texto-principal);
            font-weight: 500;
        }

        .no-data-message {
            padding: 15px;
            background-color: #fef2f2;
            border: 1px solid var(--cor-erro);
            color: var(--cor-erro);
            border-radius: 10px;
            font-weight: 500;
            margin: 20px 0;
            text-align: center;
        }


        /* Responsividade */
        @media (max-width: 1200px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-section.reunioes {
                border-right: none;
                border-bottom: 2px solid var(--cor-divisoria);
                padding-right: 0;
                padding-bottom: 30px;
                margin-bottom: 20px;
            }

            .dashboard-section.eventos {
                padding-left: 0;
            }

            .bar-chart-container {
                height: 200px;
                /* üí° CORRE√á√ÉO: Ajustado o padding-top para n√£o cortar o valor */
                padding: 30px 0 0 5px;
                padding-bottom: 20px;
                gap: 8px;
            }

            .monthly-bar-value {
                font-size: 0.85em;
                top: -16px;
            }

            .monthly-bar-label {
                font-size: 0.75em;
                margin-top: 4px;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 15px;
            }

            .kpi-grid {
                grid-template-columns: 1fr;
            }

            .kpi-card {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
            }

            .main-title {
                font-size: 2em;
            }

            .bar-chart-container {
                height: 150px;
                gap: 5px;
                /* üí° CORRE√á√ÉO: Ajustado o padding-top para n√£o cortar o valor */
                padding: 25px 0 0 5px;
                padding-bottom: 15px;
            }

            .monthly-bar-value {
                font-size: 0.8em;
                top: -15px;
            }

            .monthly-bar-label {
                font-size: 0.65em;
                margin-top: 3px;
            }
        }
    </style>
</head>

<body>

    <div class="main-container">

        <div class="main-header">
            <h1 class="main-title">Vis√£o Comparativa: Reuni√µes vs. Eventos</h1>
            <p class="subtitle">An√°lise em tempo real dos compromissos da Secretaria.</p>
            <p id="last-update" class="subtitle" style="font-size: 1em; margin-top: 15px;">
                Dados atualizados em: --:--:--
            </p>
        </div>


        <div class="comparison-grid">

            <div class="dashboard-section reunioes">
                <h2 class="section-header">Reuni√µes</h2>

                <div class="kpi-grid">
                    <div id="reunioes-status-principal" class="status-box">
                        Carregando status...
                    </div>

                    <div class="kpi-card">
                        <div class="kpi-info">
                            <h4>TOTAL DE REGISTROS</h4>
                            <p id="reunioes-total-registros-kpi">0</p>
                        </div>
                        <div class="kpi-icon"><i class="fas fa-list-alt"></i></div>
                    </div>

                    <div class="kpi-card kpi-success" id="reunioes-kpi-hoje">
                        <div class="kpi-info">
                            <h4>REUNI√ïES HOJE</h4>
                            <p id="reunioes-hoje-kpi">0</p>
                        </div>
                        <div class="kpi-icon"><i class="fas fa-calendar-check"></i></div>
                    </div>
                </div>

                <div class="content-grid">
                    <div class="data-section-card">
                        <div class="section-sub-title">Reuni√µes de Hoje</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="reunioes-header-hoje-a">REUNI√ÉO</th>
                                    <th id="reunioes-header-hoje-b">DATA</th>
                                    <th id="reunioes-header-hoje-c">HORA</th>
                                    <th id="reunioes-header-hoje-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="reunioes-dataTableBodyHoje">
                            </tbody>
                        </table>
                    </div>

                    <div class="data-section-card">
                        <div class="section-sub-title">Gr√°fico Hist√≥rico: Reuni√µes (Por M√™s)</div>
                        <div class="chart-filter-container">
                            <label for="reunioes-year-filter">Selecione o Ano:</label>
                            <select id="reunioes-year-filter" class="year-filter" disabled>
                                <option value="">Carregando...</option>
                            </select>
                        </div>
                        <div class="chart-box">
                            <div class="bar-chart-container" id="reunioes-bar-chart">
                                <p class="empty-cell">Carregando...</p>
                            </div>
                        </div>
                        <div class="chart-info-box">
                            <p>Total de Registros Futuros: <strong id="reunioes-futuras-kpi">0</strong></p>
                        </div>
                    </div>

                    <div class="data-section-card">
                        <div class="section-sub-title">Pr√≥ximas Reuni√µes</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="reunioes-header-futuras-a">REUNI√ÉO</th>
                                    <th id="reunioes-header-futuras-b">DATA</th>
                                    <th id="reunioes-header-futuras-c">HOR√ÅRIO</th>
                                    <th id="reunioes-header-futuras-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="reunioes-dataTableBodyFuturas">
                            </tbody>
                        </table>
                    </div>

                    <div class="data-section-card">
                        <div class="section-sub-title">Hist√≥rico de Reuni√µes (Realizadas)</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="reunioes-header-historico-a">REUNI√ÉO</th>
                                    <th id="reunioes-header-historico-b">DATA</th>
                                    <th id="reunioes-header-historico-c">HOR√ÅRIO</th>
                                    <th id="reunioes-header-historico-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="reunioes-dataTableBodyHistorico">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="dashboard-section eventos">
                <h2 class="section-header">Eventos</h2>

                <div class="kpi-grid">
                    <div id="eventos-status-principal" class="status-box">
                        Carregando status...
                    </div>

                    <div class="kpi-card">
                        <div class="kpi-info">
                            <h4>TOTAL DE REGISTROS</h4>
                            <p id="eventos-total-registros-kpi">0</p>
                        </div>
                        <div class="kpi-icon"><i class="fas fa-bullhorn"></i></div>
                    </div>

                    <div class="kpi-card kpi-success" id="eventos-kpi-hoje">
                        <div class="kpi-info">
                            <h4>EVENTOS HOJE</h4>
                            <p id="eventos-hoje-kpi">0</p>
                        </div>
                        <div class="kpi-icon"><i class="fas fa-calendar-alt"></i></div>
                    </div>
                </div>

                <div class="content-grid">
                    <div class="data-section-card">
                        <div class="section-sub-title">Eventos de Hoje</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="eventos-header-hoje-a">EVENTOS</th>
                                    <th id="eventos-header-hoje-b">DATA</th>
                                    <th id="eventos-header-hoje-c">HOR√ÅRIO</th>
                                    <th id="eventos-header-hoje-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="eventos-dataTableBodyHoje">
                            </tbody>
                        </table>
                    </div>

                    <div class="data-section-card">
                        <div class="section-sub-title">Gr√°fico Hist√≥rico: Eventos (Por M√™s)</div>
                        <div class="chart-filter-container">
                            <label for="eventos-year-filter">Selecione o Ano:</label>
                            <select id="eventos-year-filter" class="year-filter" disabled>
                                <option value="">Carregando...</option>
                            </select>
                        </div>
                        <div class="chart-box">
                            <div class="bar-chart-container" id="eventos-bar-chart">
                                <p class="empty-cell">Carregando...</p>
                            </div>
                        </div>
                        <div class="chart-info-box">
                            <p>Total de Registros Futuros: <strong id="eventos-futuras-kpi">0</strong></p>
                        </div>
                    </div>

                    <div class="data-section-card">
                        <div class="section-sub-title">Pr√≥ximos Eventos</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="eventos-header-futuras-a">EVENTOS</th>
                                    <th id="eventos-header-futuras-b">DATA</th>
                                    <th id="eventos-header-futuras-c">HOR√ÅRIO</th>
                                    <th id="eventos-header-futuras-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="eventos-dataTableBodyFuturas">
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="data-section-card">
                        <div class="section-sub-title">Hist√≥rico de Eventos (Realizados)</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th id="eventos-header-historico-a">EVENTOS</th>
                                    <th id="eventos-header-historico-b">DATA</th>
                                    <th id="eventos-header-historico-c">HOR√ÅRIO</th>
                                    <th id="eventos-header-historico-d">LOCAL</th>
                                </tr>
                            </thead>
                            <tbody id="eventos-dataTableBodyHistorico">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
        <div id="error-display-reunioes" style="display:none;"></div>
        <div id="error-display-eventos" style="display:none;"></div>

    </div>


    <script>
        // **!!! URL BASE DA SUA PLANILHA GOOGLE REAL !!!**
        const BASE_URL = 'https://docs.google.com/spreadsheets/d/1Xn9TXxr2Lk8yZgAkC5fMmm_klhAb6WVkDoOhD4Wr8yk/';
        const MEETINGS_GID = '1823223532'; // GID para Reuni√µes/Compromissos
        const EVENTS_GID = '1354815219'; // GID para Eventos

        // NOVOS HEADERS FIXOS PARA AS TABELAS (REUNI√ïES E EVENTOS)
        const FIXED_HEADERS = {
            'reunioes-': ['REUNI√ÉO', 'DATA', 'HOR√ÅRIO', 'LOCAL'],
            'eventos-': ['EVENTOS', 'DATA', 'HOR√ÅRIO', 'LOCAL'] // Usando AVALIA√á√ïES conforme solicitado
        };


        let allHeaders = {};
        // Armazenamento global para dados brutos, necess√°rio para o filtro de ano
        let allRawData = {};

        function buildUrl(gid) {
            // Adiciona um par√¢metro de cachebuster para garantir que o navegador n√£o use dados antigos.
            return `${BASE_URL}gviz/tq?tqx=out:csv&gid=${gid}&v=${new Date().getTime()}`;
        }

        // --- FUN√á√ïES DE PROCESSAMENTO DE DADOS (Mantidas) ---

        function formatValue(value, isHTML = true) {
            let cleanedValue = String(value).trim().replace(/^"|"$/g, '');
            if (!cleanedValue) {
                return isHTML ? '<span class="empty-cell">(Vazio)</span>' : '(Vazio)';
            }
            return cleanedValue;
        }

        function csvToJson(csv, gid) {
            if (csv.startsWith('<') || csv.startsWith('<!')) {
                throw new Error("O link de Publica√ß√£o na Web n√£o est√° ativo ou o formato retornado n√£o √© CSV.");
            }

            const lines = csv.split('\n').filter(line => line.trim() !== '');
            if (lines.length <= 1) return [];

            const rawHeaders = lines[0].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            const headers = rawHeaders.map((h, index) => {
                const cleaned = h.trim().replace(/"/g, '').toUpperCase().replace(/[^A-Z0-9]/g, '_').replace(/_+/g, '_').trim();
                return cleaned || `COLUNA_${String.fromCharCode(65 + index)}`;
            });
            allHeaders[gid] = headers;

            const result = [];
            for (let i = 1; i < lines.length; i++) {
                const obj = {};
                const currentline = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);

                if (currentline.length === 0 || currentline[0].trim().replace(/"/g, '') === '') continue;


                for (let j = 0; j < headers.length && j < currentline.length; j++) {
                    obj[headers[j]] = currentline[j].trim();
                }
                result.push(obj);
            }
            return result;
        }

        function processarDadosDoArray(dados, gid) {
            if (!Array.isArray(dados) || dados.length === 0) {
                return {
                    total: 0,
                    data: [],
                    headers: {
                        keyA: 'COLUNA_A',
                        keyB: 'COLUNA_B',
                        keyC: 'COLUNA_C',
                        keyD: 'COLUNA_D'
                    }
                };
            }

            const headers = allHeaders[gid] || [];
            const keyA = headers[0] || 'COLUNA_A';
            const keyB = headers[1] || 'COLUNA_B';
            const keyC = headers[2] || 'COLUNA_C';
            const keyD = headers[3] || 'COLUNA_D';

            const formattedData = dados.map(item => ({
                colA: item[keyA] || '',
                colB: item[keyB] || '',
                colC: item[keyC] || '',
                colD: item[keyD] || ''
            }));

            return {
                total: dados.length,
                data: formattedData,
                headers: {
                    keyA,
                    keyB,
                    keyC,
                    keyD
                }
            };
        }

        // --- FUN√á√ïES DE L√ìGICA DE DATA (AJUSTADA PARA O NOVO REQUISITO) ---

        function parseDate(dateString) {
            if (!dateString) return null;

            const cleanedString = dateString.trim().replace(/"/g, '');
            const parts = cleanedString.split('/');

            if (parts.length === 3) {
                let day = parseInt(parts[0], 10);
                let month = parseInt(parts[1], 10);
                let year = parseInt(parts[2], 10);

                if (year < 100) {
                    year = 2000 + year;
                }

                const date = new Date(year, month - 1, day);

                if (date.getFullYear() === year && date.getMonth() === month - 1 && date.getDate() === day) {
                    return date;
                }
            }
            return null;
        }

        function isToday(dateToCheck, today) {
            return dateToCheck.getFullYear() === today.getFullYear() &&
                dateToCheck.getMonth() === today.getMonth() &&
                dateToCheck.getDate() === today.getDate();
        }

        /**
         * FILTRA os itens: Hoje, Futuros (a partir de amanh√£), e Passados (antes de hoje).
         */
        function getTodayAndFutureItems(dados) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Calcula o in√≠cio do dia seguinte (00:00:00 de amanh√£)
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            let itemsHoje = [];
            let itemsPassados = []; // NOVO: Itens com data ANTERIOR a hoje
            let itemsAmanhaEmDiante = []; // Itens com data IGUAL ou POSTERIOR a amanh√£

            dados.forEach(item => {
                const itemDate = parseDate(item.colB);

                if (itemDate) {
                    const itemDateOnly = new Date(itemDate);
                    itemDateOnly.setHours(0, 0, 0, 0);

                    const itemComData = {
                        ...item,
                        parsedDate: itemDateOnly
                    };

                    // 1. ITENS DE HOJE
                    if (isToday(itemDateOnly, today)) {
                        itemsHoje.push(itemComData);
                    }

                    // 2. ITENS PASSADOS (Data ANTERIOR a hoje, ou seja, < today)
                    if (itemDateOnly < today) {
                        itemsPassados.push(itemComData);
                    }

                    // 3. ITENS FUTUROS (A partir de amanh√£)
                    if (itemDateOnly >= tomorrow) {
                        itemsAmanhaEmDiante.push(itemComData);
                    }
                }
            });

            // Ordena os itens de hoje por hora (C)
            itemsHoje.sort((a, b) => formatValue(a.colC, false).localeCompare(formatValue(b.colC, false)));

            // Ordena os itens passados por data decrescente (mais recente primeiro)
            itemsPassados.sort((a, b) => b.parsedDate.getTime() - a.parsedDate.getTime());

            // Ordena os itens futuros por data crescente e, secundariamente, por hora
            itemsAmanhaEmDiante.sort((a, b) => {
                // Ordena√ß√£o prim√°ria por data
                if (a.parsedDate < b.parsedDate) return -1;
                if (a.parsedDate > b.parsedDate) return 1;

                // Ordena√ß√£o secund√°ria por hora
                return formatValue(a.colC, false).localeCompare(formatValue(b.colC, false));
            });


            // L√≥gica do PR√ìXIMO ITEM (Pode ser HOJE ou AMANH√É em diante)
            let proximo = null;
            if (itemsHoje.length > 0) {
                proximo = itemsHoje[0]; // Prioriza o primeiro item de hoje
            } else if (itemsAmanhaEmDiante.length > 0) {
                proximo = itemsAmanhaEmDiante[0]; // Pega o primeiro a partir de amanh√£
            }

            return {
                hoje: itemsHoje,
                passados: itemsPassados, // NOVO: Tabela de Hist√≥rico
                proximo: proximo,
                todasFuturas: itemsAmanhaEmDiante // Array usado para a tabela "Pr√≥ximas..." (a partir de amanh√£)
            };
        }


        /**
         * Atualiza o Status Box e os KPIs.
         */
        function updateStatusAndKPIs(statusData, prefix, itemName) {
            const statusBox = document.getElementById(`${prefix}status-principal`);
            const kpiTotal = document.getElementById(`${prefix}total-registros-kpi`);
            const kpiHoje = document.getElementById(`${prefix}hoje-kpi`);
            const kpiFuturas = document.getElementById(`${prefix}futuras-kpi`);
            const kpiCardHoje = document.getElementById(`${prefix}kpi-hoje`);

            const {
                hoje,
                proximo,
                todasFuturas, // Agora, cont√©m apenas itens a partir de AMANH√É
            } = statusData;
            const itemUpper = itemName.toUpperCase();

            kpiTotal.textContent = statusData.dataTotal;
            kpiHoje.textContent = hoje.length;
            kpiFuturas.textContent = todasFuturas.length; // KPI de Futuros reflete o que come√ßa amanh√£

            if (hoje.length > 0) {
                kpiCardHoje.classList.add('kpi-success');
                kpiCardHoje.classList.remove('kpi-alert');
            } else {
                kpiCardHoje.classList.remove('kpi-success');
                kpiCardHoje.classList.add('kpi-alert');
            }


            // L√≥gica do Status Box
            if (hoje.length > 0) {
                const primeiraHoje = hoje[0];
                const nome = formatValue(primeiraHoje.colA, false);
                const data = formatValue(primeiraHoje.colB, false);
                const hora = formatValue(primeiraHoje.colC, false);
                const local = formatValue(primeiraHoje.colD, false);

                const localText = local ? ` Local: <strong>${local}</strong>` : '';
                const maisText = '';

                // A classe 'tippy-active' foi removida, pois n√£o haver√° tooltip
                statusBox.className = `status-box status-hoje`;
                statusBox.innerHTML = `<h3>‚úÖ ${itemUpper} HOJE, ${data}!</h3>
                                        <p><strong>${nome}</strong>, marcada para as <strong>${hora}</strong>${localText}.${maisText}</p>`;


            } else if (proximo) {
                // Se n√£o houver hoje, o 'proximo' √© o primeiro de AMANH√É em diante
                const nome = formatValue(proximo.colA, false);
                const data = formatValue(proximo.colB, false);
                const hora = formatValue(proximo.colC, false);
                const local = formatValue(proximo.colD, false);

                const statusClass = 'status-proxima';
                const localText = local ? ` Local: <strong>${local}</strong>` : '';

                statusBox.className = `status-box ${statusClass}`;
                statusBox.innerHTML = `<h3>üîî PR√ìXIM${itemUpper.endsWith('O') ? 'O' : 'A'} ${itemUpper}</h3>
                                        <p><strong>${nome}</strong>, no dia <strong>${data}</strong> √†s <strong>${hora}</strong>${localText}.</p>`;

            } else {
                statusBox.className = 'status-box status-sem-dados';
                statusBox.innerHTML = `<h3>‚ùå NENHUM ${itemUpper} ENCONTRADO</h3>
                                        <p>Sem ${itemName.toLowerCase()} agendados para o futuro.</p>`;
            }
        }


        // --- FUN√á√ïES DE RENDERIZA√á√ÉO DE TABELAS (Mantida) ---

        /**
         * Renderiza todo o array de dados na tabela.
         */
        function renderTable(data, tableBodyId) {
            const tableBody = document.getElementById(tableBodyId);
            if (!tableBody) return;

            tableBody.innerHTML = '';

            const dataToDisplay = data;
            const numColumns = 4;

            if (dataToDisplay.length === 0) {
                const row = tableBody.insertRow();
                const cell = row.insertCell(0);
                cell.innerHTML = '<span class="empty-cell" style="padding: 12px 0;">Nenhum registro encontrado.</span>';
                cell.colSpan = numColumns;
                cell.style.textAlign = 'center';
                cell.style.borderBottom = 'none';
                return;
            }

            dataToDisplay.forEach((item) => {
                const row = tableBody.insertRow();
                row.insertCell().innerHTML = formatValue(item.colA);
                row.insertCell().innerHTML = formatValue(item.colB);
                row.insertCell().innerHTML = formatValue(item.colC);
                row.insertCell().innerHTML = formatValue(item.colD);
            });
        }


        // --- FUN√á√ÉO PARA RENDERIZAR GR√ÅFICO MENSAL (Mantida) ---

        /**
         * Renderiza o Gr√°fico Mensal para o ano selecionado.
         */
        function renderMonthlyChart(data, yearToDisplay, chartContainerId, sectionClass) {
            const chartContainer = document.getElementById(chartContainerId);
            if (!chartContainer) return;

            chartContainer.innerHTML = '';

            const currentYear = parseInt(yearToDisplay);
            const monthlyCounts = {};

            // 1. Data Filtering and Calculation
            data.forEach(item => {
                const date = parseDate(item.colB);
                if (date && date.getFullYear() === currentYear) {
                    const monthLabel = date.toLocaleDateString('pt-BR', {
                        month: 'short'
                    }).toUpperCase().replace('.', '');
                    monthlyCounts[monthLabel] = (monthlyCounts[monthLabel] || 0) + 1;
                }
            });

            const monthNamesShort = ['JAN', 'FEV', 'MAR', 'ABR', 'MAI', 'JUN', 'JUL', 'AGO', 'SET', 'OUT', 'NOV', 'DEZ'];
            const countsArray = monthNamesShort.map(month => monthlyCounts[month] || 0);
            const maxCount = countsArray.length > 0 ? Math.max(...countsArray) : 0;

            if (countsArray.every(c => c === 0)) {
                const itemName = sectionClass === 'reunioes' ? 'reuni√£o' : 'evento';
                chartContainer.innerHTML = `<p class="empty-cell" style="padding: 20px;">Nenhum registro de ${itemName} encontrado para o ano de ${yearToDisplay}.</p>`;
                return;
            }

            const chartHtml = [];

            // 2. Iteration and Bar Rendering
            monthNamesShort.forEach((monthName) => {
                const currentCount = monthlyCounts[monthName] || 0;

                // Altura da barra (em %) - usa 90% para deixar espa√ßo para o valor no topo
                const heightPercentage = maxCount > 0 ? (currentCount / maxCount) * 90 : 0;
                const barColor = `var(--cor-${sectionClass === 'reunioes' ? 'reuniao' : 'evento'})`;
                const valueColor = `var(--cor-${sectionClass === 'reunioes' ? 'reuniao-dark' : 'evento-dark'})`;


                chartHtml.push(`
                    <div class="monthly-bar-wrapper">
                        <div class="monthly-bar" style="height: ${heightPercentage}%; background-color: ${barColor};">
                            <span class="monthly-bar-value" style="color: ${valueColor}; display: ${currentCount > 0 ? 'block' : 'none'};">${currentCount}</span>
                        </div>
                        <div class="monthly-bar-label">${monthName}</div>
                        </div>
                `);
            });

            chartContainer.innerHTML = chartHtml.join('');
        }

        /**
         * Inicializa o filtro de ano e o gr√°fico. (Mantida)
         */
        function initializeYearFilter(data, prefix) {
            const filterId = `${prefix}year-filter`;
            const chartContainerId = `${prefix}bar-chart`;
            const sectionClass = prefix.replace('-', '');
            const filterSelect = document.getElementById(filterId);

            if (!filterSelect) return;

            // Salva o ano selecionado antes de atualizar a lista de anos
            const selectedYearBeforeUpdate = filterSelect.value;

            // 1. Get unique years
            const uniqueYears = new Set();
            data.forEach(item => {
                const date = parseDate(item.colB);
                if (date) {
                    uniqueYears.add(date.getFullYear());
                }
            });

            const sortedYears = Array.from(uniqueYears).sort((a, b) => b - a); // Ordem decrescente

            // 2. Populate the filter
            const wasDisabled = filterSelect.disabled;
            filterSelect.innerHTML = '';
            filterSelect.disabled = false;

            if (sortedYears.length === 0) {
                filterSelect.innerHTML = '<option value="">Sem Dados</option>';
                filterSelect.disabled = true;
                // Renderiza o gr√°fico para o ano atual com 0 dados
                renderMonthlyChart([], new Date().getFullYear(), chartContainerId, sectionClass);
                return;
            }

            sortedYears.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                filterSelect.appendChild(option);
            });

            // Tenta manter o ano selecionado ou define o mais recente
            let yearToRender = sortedYears[0];
            if (sortedYears.includes(parseInt(selectedYearBeforeUpdate)) && !wasDisabled) {
                filterSelect.value = selectedYearBeforeUpdate;
                yearToRender = selectedYearBeforeUpdate;
            } else {
                filterSelect.value = sortedYears[0]; // Set the latest year as default
            }


            // 3. Initial render for the default year (or selected year)
            // Se j√° houver um listener, o render ser√° feito pelo listener. Se for o primeiro load, renderiza direto.
            renderMonthlyChart(data, yearToRender, chartContainerId, sectionClass);

            // 4. Attach event listener (garante que s√≥ √© anexado uma vez)
            if (!filterSelect.dataset.listenerAttached) {
                filterSelect.addEventListener('change', (event) => {
                    const selectedYear = event.target.value;
                    renderMonthlyChart(data, selectedYear, chartContainerId, sectionClass);
                });
                filterSelect.dataset.listenerAttached = 'true';
            }
        }


        // --- FUN√á√ÉO PRINCIPAL REUTILIZ√ÅVEL (AJUSTADA PARA INCLUIR HIST√ìRICO DE EVENTOS) ---

        async function fetchAndRenderDashboard(gid, prefix, itemName) {
            const url = buildUrl(gid);
            const errorDisplay = document.getElementById(`error-display-${prefix.replace('-', '')}`);
            let processedData = {
                total: 0,
                data: [],
                headers: {
                    keyA: 'COLUNA_A',
                    keyB: 'COLUNA_B',
                    keyC: 'COLUNA_C',
                    keyD: 'COLUNA_D'
                }
            };

            if (errorDisplay) {
                errorDisplay.style.display = 'none';
                errorDisplay.innerHTML = '';
            }

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Erro de rede ${response.status}.`);
                }

                const dadosCSV = await response.text();
                const rawData = csvToJson(dadosCSV, gid);
                processedData = processarDadosDoArray(rawData, gid);

                // NOVO: Armazena o array completo para que o filtro de ano possa consult√°-lo
                allRawData[gid] = processedData.data;

            } catch (error) {
                console.error(`ERRO CR√çTICO no carregamento de ${itemName} (GID: ${gid}):`, error);
                const errorMessageText = `Falha na Planilha. Erro: ${error.message}. Verifique se a planilha est√° **Publicada na Web** (GID ${gid}).`;

                if (errorDisplay) {
                    errorDisplay.style.display = 'block';
                    errorDisplay.innerHTML = `<div class="no-data-message">${errorMessageText}</div>`;
                }

                document.getElementById(`${prefix}total-registros-kpi`).textContent = 'N/A';
                document.getElementById(`${prefix}hoje-kpi`).textContent = 'N/A';
                document.getElementById(`${prefix}futuras-kpi`).textContent = 'N/A';

                const statusBox = document.getElementById(`${prefix}status-principal`);
                if (statusBox) {
                    statusBox.className = 'status-box status-sem-dados';
                    statusBox.innerHTML = `<h3>‚ùå DADOS INDISPON√çVEIS</h3><p>Erro no carregamento de ${itemName}.</p>`;
                }
                document.getElementById(`${prefix}bar-chart`).innerHTML = `<p class="empty-cell" style="padding: 20px;">Sem dados.</p>`;
                renderTable([], `${prefix}dataTableBodyFuturas`);
                renderTable([], `${prefix}dataTableBodyHoje`);
                // Renderiza o hist√≥rico mesmo em caso de erro para zerar a tabela
                renderTable([], `${prefix}dataTableBodyHistorico`);


                // Tenta inicializar o filtro mesmo sem dados para mostrar "Sem Dados"
                initializeYearFilter([], prefix);

                // Aplica os headers fixos (incluindo o de hist√≥rico para ambas as se√ß√µes)
                const headerPrefixes = [`${prefix}header-futuras-`, `${prefix}header-hoje-`, `${prefix}header-historico-`];
                const headerNames = ['a', 'b', 'c', 'd'];
                const fixedHeaderValues = FIXED_HEADERS[prefix];

                headerNames.forEach((name, index) => {
                    headerPrefixes.forEach(hPrefix => {
                        const element = document.getElementById(`${hPrefix}${name}`);
                        if (element && fixedHeaderValues[index]) {
                            element.textContent = fixedHeaderValues[index];
                        }
                    });
                });

                return;
            }

            // 1. Atualiza Headers da Tabela
            // O array de prefixos deve incluir o hist√≥rico para Eventos tamb√©m
            const headerPrefixes = [`${prefix}header-futuras-`, `${prefix}header-hoje-`, `${prefix}header-historico-`];
            const headerNames = ['a', 'b', 'c', 'd'];
            const headerKeys = [processedData.headers.keyA, processedData.headers.keyB, processedData.headers.keyC, processedData.headers.keyD];
            const formattedHeaders = {};

            // Headers fixos para as tabelas
            const fixedHeaderValues = FIXED_HEADERS[prefix];


            headerNames.forEach((name, index) => {
                // Tenta usar o header da planilha. Se for gen√©rico, usa o header fixo.
                let dynamicHeader = headerKeys[index] ? headerKeys[index].replace(/_/g, ' ').toLowerCase().replace(/\b\w/g, c => c.toUpperCase()) : fixedHeaderValues[index];

                // For√ßa o header din√¢mico (usado no Status Box) a usar o nome fixo se for um fallback gen√©rico (Coluna A, B, etc)
                if (dynamicHeader.startsWith('Coluna')) {
                    dynamicHeader = fixedHeaderValues[index];
                }

                formattedHeaders[`col${name.toUpperCase()}`] = dynamicHeader;

                // Aplica o cabe√ßalho FIXO nas tabelas (Futuras, Hoje e Hist√≥rico)
                headerPrefixes.forEach(hPrefix => {
                    const element = document.getElementById(`${hPrefix}${name}`);
                    if (element) {
                        element.textContent = fixedHeaderValues[index]; // Usa o valor fixo
                    }
                });
            });


            // 2. Processa Status, KPIs e Tabelas
            const itemsStatus = getTodayAndFutureItems(processedData.data);
            itemsStatus.dataTotal = processedData.total;
            itemsStatus.formattedHeaders = formattedHeaders;

            updateStatusAndKPIs(itemsStatus, prefix, itemName);

            // A tabela "Pr√≥ximas Reuni√µes/Eventos" usa itemsStatus.todasFuturas (a partir de amanh√£)
            renderTable(itemsStatus.todasFuturas, `${prefix}dataTableBodyFuturas`);

            // Renderiza a Tabela de Hoje.
            renderTable(itemsStatus.hoje, `${prefix}dataTableBodyHoje`);

            // Renderiza a Tabela de Hist√≥rico para Reuni√µes E Eventos (nova implementa√ß√£o)
            renderTable(itemsStatus.passados, `${prefix}dataTableBodyHistorico`);


            // 3. Inicializa o Filtro de Ano e Renderiza o Gr√°fico Mensal
            initializeYearFilter(processedData.data, prefix);
        }

        // --- INICIALIZA√á√ÉO E REFRESH ---

        // Fun√ß√£o que ser√° chamada a cada 3 segundos
        async function loadAllData() {
            // console.log('Iniciando atualiza√ß√£o de dados...');

            // Chama a fun√ß√£o principal para as duas se√ß√µes
            await fetchAndRenderDashboard(MEETINGS_GID, 'reunioes-', 'Reuni√£o');
            await fetchAndRenderDashboard(EVENTS_GID, 'eventos-', 'Evento');

            // Atualiza o indicador de √∫ltima atualiza√ß√£o
            const updateTime = new Date().toLocaleTimeString('pt-BR');
            const lastUpdateElement = document.getElementById('last-update');
            if (lastUpdateElement) {
                lastUpdateElement.innerHTML = `Dados atualizados em: <strong>${updateTime}</strong>`;
            }

            // console.log('Atualiza√ß√£o conclu√≠da.');
        }


        document.addEventListener('DOMContentLoaded', async () => {
            // 1. Carregamento inicial (o await garante que a p√°gina n√£o fica em branco por muito tempo)
            await loadAllData();

            // 2. Agendamento da atualiza√ß√£o a cada 3 segundos (3000 ms)
            // O setInterval continuar√° chamando a fun√ß√£o loadAllData indefinidamente.
            setInterval(loadAllData, 3000);
        });

        // -----------------------------------------------------
        // --- MEDIDAS DE "SEGURAN√áA POR OBSCURIDADE" (MELHORADAS) ---
        // -----------------------------------------------------

        // Desabilita o menu de contexto (bot√£o direito do mouse)
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        });

        // Desabilita teclas comuns do DevTools e outras
        document.addEventListener('keydown', function (e) {
            // F12 check
            const isF12 = e.key === 'F12' || e.keyCode === 123;
            // Ctrl+Shift+I check (I = 73)
            const isCtrlShiftI = e.ctrlKey && e.shiftKey && (e.key === 'I' || e.keyCode === 73);
            // Ctrl+Shift+J check (J = 74)
            const isCtrlShiftJ = e.ctrlKey && e.shiftKey && (e.key === 'J' || e.keyCode === 74);
            // Ctrl+U check (U = 85) - Ver C√≥digo Fonte
            const isCtrlU = e.ctrlKey && (e.key === 'U' || e.keyCode === 85);
            // Ctrl+S check (S = 83) - Impede Salvar P√°gina
            const isCtrlS = e.ctrlKey && (e.key === 'S' || e.keyCode === 83);
            // Ctrl+Shift+C check (C = 67) - Selecionar Elemento
            const isCtrlShiftC = e.ctrlKey && e.shiftKey && (e.key === 'C' || e.keyCode === 67);

            if (isF12 || isCtrlShiftI || isCtrlU || isCtrlShiftJ || isCtrlS || isCtrlShiftC) {
                e.preventDefault();
            }
        });

        // Novo: Detec√ß√£o Ativa de DevTools (console.log)
        // Se o console estiver aberto, a fun√ß√£o 'console.log' com um objeto demora muito mais a ser executada.
        const devtoolsCheck = () => {
            const threshold = 100; // Tempo limite em milissegundos
            const loop = () => {
                const start = performance.now();
                // Tenta logar um objeto para for√ßar o DevTools a inspecionar, o que atrasa a execu√ß√£o se estiver aberto.
                console.log('%c', 'display: none');
                const end = performance.now();

                // Se a diferen√ßa de tempo for maior que o limite, o DevTools est√° aberto.
                if (end - start > threshold) {
                    // Bloqueio: Redireciona para uma p√°gina vazia ou fecha a janela
                    document.body.innerHTML = '<h1>Acesso negado.</h1>';
                    // window.close(); // Pode n√£o funcionar na maioria dos navegadores
                }

                // Executa a cada X milissegundos
                setTimeout(loop, 500);
            };
            loop(); // Inicia o loop
        };
        // Tenta iniciar a checagem se o console estiver dispon√≠vel
        if (window.console && window.console.log) {
            devtoolsCheck();
        }

        // -----------------------------------------------------
        // --- FIM MEDIDAS DE "SEGURAN√áA POR OBSCURIDADE" ---
        // ------------------------------------------------------

    </script>
</body>

</html>